2012/10/04 takeshi:

Problems with json libraries with centos 3.9:

[root@centos39-02101 install]# cat /etc/issue
CentOS release 3.9 (Final)
Kernel \r on an \m


1) json-c:

json-c cannot be built with centos 3.9 (configure will fail):

config.status: executing libtool commands
(CDPATH="${ZSH_VERSION+.}:" && cd . && /bin/sh /usr/local/src/json-c-0.10/missing --run autoheader)
aclocal.m4:20: warning: this file was generated for autoconf 2.68.
You have another version of autoconf.  It may work, but is not guaranteed to.
If you have problems, you may need to regenerate the build system entirely.
To do so, use the procedure documented by the package, typically `autoreconf'.
configure.in:6: error: Autoconf version 2.62 or higher is required
aclocal.m4:8485: AM_INIT_AUTOMAKE is expanded from...
configure.in:6: the top level
autom4te: /usr/bin/m4 failed with exit status: 1
autoheader: /usr/bin/autom4te failed with exit status: 1
make: *** [config.h.in] Error 1


2) json-glib json-glib-0.14.2 also will not work because it depends on newer glib


3) libjson_7.6.1.zip will not be used as it seems it was originally written for Windows


4) jansson-2.4 will not compile:

make  all-recursive
make[1]: Entering directory `/usr/local/src/jansson-2.4'
Making all in doc
make[2]: Entering directory `/usr/local/src/jansson-2.4/doc'
make[2]: Nothing to be done for `all'.
make[2]: Leaving directory `/usr/local/src/jansson-2.4/doc'
Making all in src
make[2]: Entering directory `/usr/local/src/jansson-2.4/src'
/bin/sh ../libtool --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I..    -Wall -Wextra -Wdeclaration-after-statement -Werror -g -O2 -MT dump.lo -MD -MP -MF .deps/dump.Tpo -c -o dump.lo dump.c
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I.. -Wall -Wextra -Wdeclaration-after-statement -Werror -g -O2 -MT dump.lo -MD -MP -MF .deps/dump.Tpo -c dump.c  -fPIC -DPIC -o .libs/dump.o
cc1: unrecognized option `-Wextra'
make[2]: *** [dump.lo] Error 1
make[2]: Leaving directory `/usr/local/src/jansson-2.4/src'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/usr/local/src/jansson-2.4'
make: *** [all] Error 2

5) yajl might be used (http://github.com/lloyd/yajl/tarball/2.0.1) but we need to install ruby and cmake to build it (have not tried yet)
  

Because of the above issues, we decided to implement our own json parser: minijson.

===============================================================================================================
2012/10/05 takeshi:

We have update our code and now we provide full and pull methods to work with json (but currently only for objects {}, but not arrays []).
See minijson_test.c for example of usage.

ToDo:
  - we need to implement full and pull functions to parse arrays (currently we have only functions to parse objects). This should not be difficult to implement, as arrays are simpler than objects: we just have to implement a FSM for the parser copying from the one coded for objects. But since we have not expectation of use for this soon, we will leave for when it becomes necessary.
  - we need to improve checking of numeric values (ex: currently we allow 000 as a number, which is not valid according to json spec)

===============================================================================================================
2012/10/18 takeshi:

